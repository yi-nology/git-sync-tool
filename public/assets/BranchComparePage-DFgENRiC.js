import{v as Ye,k as Qe,j as Ze,D as te,G as K,E as C,F as _,u as de,z as ne,R as ue,az as et,r as J,ac as R,y as A,S as U,M as be,a6 as ge,U as fe,c as xe,I as tt}from"./vendor-BwpG93hR.js";import{e as nt,A as st,g as it,c as lt,k as at,B as rt,b as _e}from"./element-plus-BS7CnCwq.js";import{g as ot,i as ct,j as dt,k as ut,m as ft,l as ht}from"./branch-DTLR2Pkm.js";import{_ as pt}from"./index-Bev_lS0N.js";import"./request-BBaptrTN.js";var W;(function(s){s.INSERT="insert",s.DELETE="delete",s.CONTEXT="context"})(W||(W={}));const mt={LINE_BY_LINE:"line-by-line"},bt={NONE:"none"},gt={WORD:"word"};var he;(function(s){s.AUTO="auto",s.DARK="dark",s.LIGHT="light"})(he||(he={}));const vt=["-","[","]","/","{","}","(",")","*","+","?",".","\\","^","$","|"],wt=RegExp("["+vt.join("\\")+"]","g");function yt(s){return s.replace(wt,"\\$&")}function Be(s){return s&&s.replace(/\\/g,"/")}function Tt(s){let n,t,e,i=0;for(n=0,e=s.length;n<e;n++)t=s.charCodeAt(n),i=(i<<5)-i+t,i|=0;return i}function Ue(s){const n=s.length;let t=-1/0;for(let e=0;e<n;e++)t=Math.max(t,s[e]);return t}function Oe(s,n){const t=s.split(".");return t.length>1?t[t.length-1]:n}function He(s,n){return n.reduce((t,e)=>t||s.startsWith(e),!1)}const Re=["a/","b/","i/","w/","c/","o/"];function oe(s,n,t){const e=t!==void 0?[...Re,t]:Re,i=n?new RegExp(`^${yt(n)} "?(.+?)"?$`):new RegExp('^"?(.+?)"?$'),[,o=""]=i.exec(s)||[],l=e.find(h=>o.indexOf(h)===0);return(l?o.slice(l.length):o).replace(/\s+\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}(?:\.\d+)? [+-]\d{4}.*$/,"")}function Ct(s,n){return oe(s,"---",n)}function Nt(s,n){return oe(s,"+++",n)}function xt(s,n={}){const t=[];let e=null,i=null,o=null,l=null,f=null,h=null,p=null;const v="--- ",x="+++ ",L="@@",a=/^old mode (\d{6})/,d=/^new mode (\d{6})/,y=/^deleted file mode (\d{6})/,b=/^new file mode (\d{6})/,T=/^copy from "?(.+)"?/,E=/^copy to "?(.+)"?/,N=/^rename from "?(.+)"?/,F=/^rename to "?(.+)"?/,P=/^similarity index (\d+)%/,I=/^dissimilarity index (\d+)%/,le=/^index ([\da-z]+)\.\.([\da-z]+)\s*(\d{6})?/,r=/^Binary files (.*) and (.*) differ/,m=/^GIT binary patch/,u=/^index ([\da-z]+),([\da-z]+)\.\.([\da-z]+)/,c=/^mode (\d{6}),(\d{6})\.\.(\d{6})/,k=/^new file mode (\d{6})/,O=/^deleted file mode (\d{6}),(\d{6})/,V=s.replace(/\\ No newline at end of file/g,"").replace(/\r\n?/g,`
`).split(`
`);function M(){i!==null&&e!==null&&(e.blocks.push(i),i=null)}function z(){e!==null&&(!e.oldName&&h!==null&&(e.oldName=h),!e.newName&&p!==null&&(e.newName=p),e.newName&&(t.push(e),e=null)),h=null,p=null}function q(){M(),z(),e={blocks:[],deletedLines:0,addedLines:0}}function $(g){M();let D;e!==null&&((D=/^@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@.*/.exec(g))?(e.isCombined=!1,o=parseInt(D[1],10),f=parseInt(D[2],10)):(D=/^@@@ -(\d+)(?:,\d+)? -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@@.*/.exec(g))?(e.isCombined=!0,o=parseInt(D[1],10),l=parseInt(D[2],10),f=parseInt(D[3],10)):(g.startsWith(L)&&console.error("Failed to parse lines, starting in 0!"),o=0,f=0,e.isCombined=!1)),i={lines:[],oldStartLine:o,oldStartLine2:l,newStartLine:f,header:g}}function H(g){if(e===null||i===null||o===null||f===null)return;const D={content:g},w=e.isCombined?["+ "," +","++"]:["+"],X=e.isCombined?["- "," -","--"]:["-"];He(g,w)?(e.addedLines++,D.type=W.INSERT,D.oldNumber=void 0,D.newNumber=f++):He(g,X)?(e.deletedLines++,D.type=W.DELETE,D.oldNumber=o++,D.newNumber=void 0):(D.type=W.CONTEXT,D.oldNumber=o++,D.newNumber=f++),i.lines.push(D)}function Q(g,D){let w=D;for(;w<V.length-3;){if(g.startsWith("diff"))return!1;if(V[w].startsWith(v)&&V[w+1].startsWith(x)&&V[w+2].startsWith(L))return!0;w++}return!1}return V.forEach((g,D)=>{if(!g||g.startsWith("*"))return;let w;const X=V[D-1],re=V[D+1],me=V[D+2];if(g.startsWith("diff --git")||g.startsWith("diff --combined")){if(q(),(w=/^diff --git "?([a-ciow]\/.+)"? "?([a-ciow]\/.+)"?/.exec(g))&&(h=oe(w[1],void 0,n.dstPrefix),p=oe(w[2],void 0,n.srcPrefix)),e===null)throw new Error("Where is my file !!!");e.isGitDiff=!0;return}if(g.startsWith("Binary files")&&!e?.isGitDiff){if(q(),(w=/^Binary files "?([a-ciow]\/.+)"? and "?([a-ciow]\/.+)"? differ/.exec(g))&&(h=oe(w[1],void 0,n.dstPrefix),p=oe(w[2],void 0,n.srcPrefix)),e===null)throw new Error("Where is my file !!!");e.isBinary=!0;return}if((!e||!e.isGitDiff&&e&&g.startsWith(v)&&re.startsWith(x)&&me.startsWith(L))&&q(),e?.isTooBig)return;if(e&&(typeof n.diffMaxChanges=="number"&&e.addedLines+e.deletedLines>n.diffMaxChanges||typeof n.diffMaxLineLength=="number"&&g.length>n.diffMaxLineLength)){e.isTooBig=!0,e.addedLines=0,e.deletedLines=0,e.blocks=[],i=null;const ce=typeof n.diffTooBigMessage=="function"?n.diffTooBigMessage(t.length):"Diff too big to be displayed";$(ce);return}if(g.startsWith(v)&&re.startsWith(x)||g.startsWith(x)&&X.startsWith(v)){if(e&&!e.oldName&&g.startsWith("--- ")&&(w=Ct(g,n.srcPrefix))){e.oldName=w,e.language=Oe(e.oldName,e.language);return}if(e&&!e.newName&&g.startsWith("+++ ")&&(w=Nt(g,n.dstPrefix))){e.newName=w,e.language=Oe(e.newName,e.language);return}}if(e&&(g.startsWith(L)||e.isGitDiff&&e.oldName&&e.newName&&!i)){$(g);return}if(i&&(g.startsWith("+")||g.startsWith("-")||g.startsWith(" "))){H(g);return}const ae=!Q(g,D);if(e===null)throw new Error("Where is my file !!!");(w=a.exec(g))?e.oldMode=w[1]:(w=d.exec(g))?e.newMode=w[1]:(w=y.exec(g))?(e.deletedFileMode=w[1],e.isDeleted=!0):(w=b.exec(g))?(e.newFileMode=w[1],e.isNew=!0):(w=T.exec(g))?(ae&&(e.oldName=w[1]),e.isCopy=!0):(w=E.exec(g))?(ae&&(e.newName=w[1]),e.isCopy=!0):(w=N.exec(g))?(ae&&(e.oldName=w[1]),e.isRename=!0):(w=F.exec(g))?(ae&&(e.newName=w[1]),e.isRename=!0):(w=r.exec(g))?(e.isBinary=!0,e.oldName=oe(w[1],void 0,n.srcPrefix),e.newName=oe(w[2],void 0,n.dstPrefix),$("Binary file")):m.test(g)?(e.isBinary=!0,$(g)):(w=P.exec(g))?e.unchangedPercentage=parseInt(w[1],10):(w=I.exec(g))?e.changedPercentage=parseInt(w[1],10):(w=le.exec(g))?(e.checksumBefore=w[1],e.checksumAfter=w[2],w[3]&&(e.mode=w[3])):(w=u.exec(g))?(e.checksumBefore=[w[2],w[3]],e.checksumAfter=w[1]):(w=c.exec(g))?(e.oldMode=[w[2],w[3]],e.newMode=w[1]):(w=k.exec(g))?(e.newFileMode=w[1],e.isNew=!0):(w=O.exec(g))&&(e.deletedFileMode=w[1],e.isDeleted=!0)}),M(),z(),t}class Ge{diff(n,t,e={}){let i;typeof e=="function"?(i=e,e={}):"callback"in e&&(i=e.callback);const o=this.castInput(n,e),l=this.castInput(t,e),f=this.removeEmpty(this.tokenize(o,e)),h=this.removeEmpty(this.tokenize(l,e));return this.diffWithOptionsObj(f,h,e,i)}diffWithOptionsObj(n,t,e,i){var o;const l=E=>{if(E=this.postProcess(E,e),i){setTimeout(function(){i(E)},0);return}else return E},f=t.length,h=n.length;let p=1,v=f+h;e.maxEditLength!=null&&(v=Math.min(v,e.maxEditLength));const x=(o=e.timeout)!==null&&o!==void 0?o:1/0,L=Date.now()+x,a=[{oldPos:-1,lastComponent:void 0}];let d=this.extractCommon(a[0],t,n,0,e);if(a[0].oldPos+1>=h&&d+1>=f)return l(this.buildValues(a[0].lastComponent,t,n));let y=-1/0,b=1/0;const T=()=>{for(let E=Math.max(y,-p);E<=Math.min(b,p);E+=2){let N;const F=a[E-1],P=a[E+1];F&&(a[E-1]=void 0);let I=!1;if(P){const r=P.oldPos-E;I=P&&0<=r&&r<f}const le=F&&F.oldPos+1<h;if(!I&&!le){a[E]=void 0;continue}if(!le||I&&F.oldPos<P.oldPos?N=this.addToPath(P,!0,!1,0,e):N=this.addToPath(F,!1,!0,1,e),d=this.extractCommon(N,t,n,E,e),N.oldPos+1>=h&&d+1>=f)return l(this.buildValues(N.lastComponent,t,n))||!0;a[E]=N,N.oldPos+1>=h&&(b=Math.min(b,E-1)),d+1>=f&&(y=Math.max(y,E+1))}p++};if(i)(function E(){setTimeout(function(){if(p>v||Date.now()>L)return i(void 0);T()||E()},0)})();else for(;p<=v&&Date.now()<=L;){const E=T();if(E)return E}}addToPath(n,t,e,i,o){const l=n.lastComponent;return l&&!o.oneChangePerToken&&l.added===t&&l.removed===e?{oldPos:n.oldPos+i,lastComponent:{count:l.count+1,added:t,removed:e,previousComponent:l.previousComponent}}:{oldPos:n.oldPos+i,lastComponent:{count:1,added:t,removed:e,previousComponent:l}}}extractCommon(n,t,e,i,o){const l=t.length,f=e.length;let h=n.oldPos,p=h-i,v=0;for(;p+1<l&&h+1<f&&this.equals(e[h+1],t[p+1],o);)p++,h++,v++,o.oneChangePerToken&&(n.lastComponent={count:1,previousComponent:n.lastComponent,added:!1,removed:!1});return v&&!o.oneChangePerToken&&(n.lastComponent={count:v,previousComponent:n.lastComponent,added:!1,removed:!1}),n.oldPos=h,p}equals(n,t,e){return e.comparator?e.comparator(n,t):n===t||!!e.ignoreCase&&n.toLowerCase()===t.toLowerCase()}removeEmpty(n){const t=[];for(let e=0;e<n.length;e++)n[e]&&t.push(n[e]);return t}castInput(n,t){return n}tokenize(n,t){return Array.from(n)}join(n){return n.join("")}postProcess(n,t){return n}get useLongestToken(){return!1}buildValues(n,t,e){const i=[];let o;for(;n;)i.push(n),o=n.previousComponent,delete n.previousComponent,n=o;i.reverse();const l=i.length;let f=0,h=0,p=0;for(;f<l;f++){const v=i[f];if(v.removed)v.value=this.join(e.slice(p,p+v.count)),p+=v.count;else{if(!v.added&&this.useLongestToken){let x=t.slice(h,h+v.count);x=x.map(function(L,a){const d=e[p+a];return d.length>L.length?d:L}),v.value=this.join(x)}else v.value=this.join(t.slice(h,h+v.count));h+=v.count,v.added||(p+=v.count)}}return i}}class _t extends Ge{}const Et=new _t;function St(s,n,t){return Et.diff(s,n,t)}const Ae="a-zA-Z0-9_\\u{AD}\\u{C0}-\\u{D6}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}";class Lt extends Ge{tokenize(n){const t=new RegExp(`(\\r?\\n)|[${Ae}]+|[^\\S\\n\\r]+|[^${Ae}]`,"ug");return n.match(t)||[]}}const Pt=new Lt;function Dt(s,n,t){return Pt.diff(s,n,t)}function Mt(s,n){if(s.length===0)return n.length;if(n.length===0)return s.length;const t=[];let e;for(e=0;e<=n.length;e++)t[e]=[e];let i;for(i=0;i<=s.length;i++)t[0][i]=i;for(e=1;e<=n.length;e++)for(i=1;i<=s.length;i++)n.charAt(e-1)===s.charAt(i-1)?t[e][i]=t[e-1][i-1]:t[e][i]=Math.min(t[e-1][i-1]+1,Math.min(t[e][i-1]+1,t[e-1][i]+1));return t[n.length][s.length]}function De(s){return(n,t)=>{const e=s(n).trim(),i=s(t).trim();return Mt(e,i)/(e.length+i.length)}}function Me(s){function n(e,i,o=new Map){let l=1/0,f;for(let h=0;h<e.length;++h)for(let p=0;p<i.length;++p){const v=JSON.stringify([e[h],i[p]]);let x;o.has(v)&&(x=o.get(v))||(x=s(e[h],i[p]),o.set(v,x)),x<l&&(l=x,f={indexA:h,indexB:p,score:l})}return f}function t(e,i,o=0,l=new Map){const f=n(e,i,l);if(!f||e.length+i.length<3)return[[e,i]];const h=e.slice(0,f.indexA),p=i.slice(0,f.indexB),v=[e[f.indexA]],x=[i[f.indexB]],L=f.indexA+1,a=f.indexB+1,d=e.slice(L),y=i.slice(a),b=t(h,p,o+1,l),T=t(v,x,o+1,l),E=t(d,y,o+1,l);let N=T;return(f.indexA>0||f.indexB>0)&&(N=b.concat(N)),(e.length>L||i.length>a)&&(N=N.concat(E)),N}return t}const G={INSERTS:"d2h-ins",DELETES:"d2h-del",CONTEXT:"d2h-cntx",INFO:"d2h-info",INSERT_CHANGES:"d2h-ins d2h-change",DELETE_CHANGES:"d2h-del d2h-change"},Ce={matching:bt.NONE,matchWordsThreshold:.25,maxLineLengthHighlight:1e4,diffStyle:gt.WORD,colorScheme:he.LIGHT},se="/",Xe=De(s=>s.value),It=Me(Xe);function Ee(s){return s.indexOf("dev/null")!==-1}function kt(s){return s.replace(/(<ins[^>]*>((.|\n)*?)<\/ins>)/g,"")}function Ft(s){return s.replace(/(<del[^>]*>((.|\n)*?)<\/del>)/g,"")}function Te(s){switch(s){case W.CONTEXT:return G.CONTEXT;case W.INSERT:return G.INSERTS;case W.DELETE:return G.DELETES}}function Ie(s){switch(s){case he.DARK:return"d2h-dark-color-scheme";case he.AUTO:return"d2h-auto-color-scheme";case he.LIGHT:default:return"d2h-light-color-scheme"}}function Bt(s){return s?2:1}function pe(s){return s.slice(0).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function ie(s,n,t=!0){const e=Bt(n);return{prefix:s.substring(0,e),content:t?pe(s.substring(e)):s.substring(e)}}function Ne(s){const n=Be(s.oldName),t=Be(s.newName);if(n!==t&&!Ee(n)&&!Ee(t)){const e=[],i=[],o=n.split(se),l=t.split(se),f=o.length,h=l.length;let p=0,v=f-1,x=h-1;for(;p<v&&p<x&&o[p]===l[p];)e.push(l[p]),p+=1;for(;v>p&&x>p&&o[v]===l[x];)i.unshift(l[x]),v-=1,x-=1;const L=e.join(se),a=i.join(se),d=o.slice(p,v+1).join(se),y=l.slice(p,x+1).join(se);return L.length&&a.length?L+se+"{"+d+" → "+y+"}"+se+a:L.length?L+se+"{"+d+" → "+y+"}":a.length?"{"+d+" → "+y+"}"+se+a:n+" → "+t}else return Ee(t)?n:t}function ke(s){return`d2h-${Tt(Ne(s)).toString().slice(-6)}`}function Fe(s){let n="file-changed";return s.isRename||s.isCopy?n="file-renamed":s.isNew?n="file-added":s.isDeleted?n="file-deleted":s.newName!==s.oldName&&(n="file-renamed"),n}function Ke(s,n,t,e={}){const{matching:i,maxLineLengthHighlight:o,matchWordsThreshold:l,diffStyle:f}=Object.assign(Object.assign({},Ce),e),h=ie(s,t,!1),p=ie(n,t,!1);if(h.content.length>o||p.content.length>o)return{oldLine:{prefix:h.prefix,content:pe(h.content)},newLine:{prefix:p.prefix,content:pe(p.content)}};const v=f==="char"?St(h.content,p.content):Dt(h.content,p.content),x=[];if(f==="word"&&i==="words"){const a=v.filter(b=>b.removed),d=v.filter(b=>b.added);It(d,a).forEach(b=>{b[0].length===1&&b[1].length===1&&Xe(b[0][0],b[1][0])<l&&(x.push(b[0][0]),x.push(b[1][0]))})}const L=v.reduce((a,d)=>{const y=d.added?"ins":d.removed?"del":null,b=x.indexOf(d)>-1?' class="d2h-change"':"",T=pe(d.value);return y!==null?`${a}<${y}${b}>${T}</${y}>`:`${a}${T}`},"");return{oldLine:{prefix:h.prefix,content:kt(L)},newLine:{prefix:p.prefix,content:Ft(L)}}}const We="file-summary",Ot="icon",Ht={colorScheme:Ce.colorScheme};class Rt{constructor(n,t={}){this.hoganUtils=n,this.config=Object.assign(Object.assign({},Ht),t)}render(n){const t=n.map(e=>this.hoganUtils.render(We,"line",{fileHtmlId:ke(e),oldName:e.oldName,newName:e.newName,fileName:Ne(e),deletedLines:"-"+e.deletedLines,addedLines:"+"+e.addedLines},{fileIcon:this.hoganUtils.template(Ot,Fe(e))})).join(`
`);return this.hoganUtils.render(We,"wrapper",{colorScheme:Ie(this.config.colorScheme),filesNumber:n.length,files:t})}}const qe=Object.assign(Object.assign({},Ce),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200}),ve="generic",je="line-by-line",At="icon",Wt="tag";class jt{constructor(n,t={}){this.hoganUtils=n,this.config=Object.assign(Object.assign({},qe),t)}render(n){const t=n.map(e=>{let i;return e.blocks.length?i=this.generateFileHtml(e):i=this.generateEmptyDiff(),this.makeFileDiffHtml(e,i)}).join(`
`);return this.hoganUtils.render(ve,"wrapper",{colorScheme:Ie(this.config.colorScheme),content:t})}makeFileDiffHtml(n,t){if(this.config.renderNothingWhenEmpty&&Array.isArray(n.blocks)&&n.blocks.length===0)return"";const e=this.hoganUtils.template(je,"file-diff"),i=this.hoganUtils.template(ve,"file-path"),o=this.hoganUtils.template(At,"file"),l=this.hoganUtils.template(Wt,Fe(n));return e.render({file:n,fileHtmlId:ke(n),diffs:t,filePath:i.render({fileDiffName:Ne(n)},{fileIcon:o,fileTag:l})})}generateEmptyDiff(){return this.hoganUtils.render(ve,"empty-diff",{contentClass:"d2h-code-line",CSSLineClass:G})}generateFileHtml(n){const t=Me(De(e=>ie(e.content,n.isCombined).content));return n.blocks.map(e=>{let i=this.hoganUtils.render(ve,"block-header",{CSSLineClass:G,blockHeader:n.isTooBig?e.header:pe(e.header),lineClass:"d2h-code-linenumber",contentClass:"d2h-code-line"});return this.applyLineGroupping(e).forEach(([o,l,f])=>{if(l.length&&f.length&&!o.length)this.applyRematchMatching(l,f,t).map(([h,p])=>{const{left:v,right:x}=this.processChangedLines(n,n.isCombined,h,p);i+=v,i+=x});else if(o.length)o.forEach(h=>{const{prefix:p,content:v}=ie(h.content,n.isCombined);i+=this.generateSingleLineHtml(n,{type:G.CONTEXT,prefix:p,content:v,oldNumber:h.oldNumber,newNumber:h.newNumber})});else if(l.length||f.length){const{left:h,right:p}=this.processChangedLines(n,n.isCombined,l,f);i+=h,i+=p}else console.error("Unknown state reached while processing groups of lines",o,l,f)}),i}).join(`
`)}applyLineGroupping(n){const t=[];let e=[],i=[];for(let o=0;o<n.lines.length;o++){const l=n.lines[o];(l.type!==W.INSERT&&i.length||l.type===W.CONTEXT&&e.length>0)&&(t.push([[],e,i]),e=[],i=[]),l.type===W.CONTEXT?t.push([[l],[],[]]):l.type===W.INSERT&&e.length===0?t.push([[],[],[l]]):l.type===W.INSERT&&e.length>0?i.push(l):l.type===W.DELETE&&e.push(l)}return(e.length||i.length)&&(t.push([[],e,i]),e=[],i=[]),t}applyRematchMatching(n,t,e){const i=n.length*t.length,o=Ue(n.concat(t).map(f=>f.content.length));return i<this.config.matchingMaxComparisons&&o<this.config.maxLineSizeInBlockForComparison&&(this.config.matching==="lines"||this.config.matching==="words")?e(n,t):[[n,t]]}processChangedLines(n,t,e,i){const o={right:"",left:""},l=Math.max(e.length,i.length);for(let f=0;f<l;f++){const h=e[f],p=i[f],v=h!==void 0&&p!==void 0?Ke(h.content,p.content,t,this.config):void 0,x=h!==void 0&&h.oldNumber!==void 0?Object.assign(Object.assign({},v!==void 0?{prefix:v.oldLine.prefix,content:v.oldLine.content,type:G.DELETE_CHANGES}:Object.assign(Object.assign({},ie(h.content,t)),{type:Te(h.type)})),{oldNumber:h.oldNumber,newNumber:h.newNumber}):void 0,L=p!==void 0&&p.newNumber!==void 0?Object.assign(Object.assign({},v!==void 0?{prefix:v.newLine.prefix,content:v.newLine.content,type:G.INSERT_CHANGES}:Object.assign(Object.assign({},ie(p.content,t)),{type:Te(p.type)})),{oldNumber:p.oldNumber,newNumber:p.newNumber}):void 0,{left:a,right:d}=this.generateLineHtml(n,x,L);o.left+=a,o.right+=d}return o}generateLineHtml(n,t,e){return{left:this.generateSingleLineHtml(n,t),right:this.generateSingleLineHtml(n,e)}}generateSingleLineHtml(n,t){if(t===void 0)return"";const e=this.hoganUtils.render(je,"numbers",{oldNumber:t.oldNumber||"",newNumber:t.newNumber||""});return this.hoganUtils.render(ve,"line",{type:t.type,lineClass:"d2h-code-linenumber",contentClass:"d2h-code-line",prefix:t.prefix===" "?"&nbsp;":t.prefix,content:t.content,lineNumber:e,line:t,file:n})}}const Je=Object.assign(Object.assign({},Ce),{renderNothingWhenEmpty:!1,matchingMaxComparisons:2500,maxLineSizeInBlockForComparison:200}),we="generic",zt="side-by-side",Vt="icon",$t="tag";class Ut{constructor(n,t={}){this.hoganUtils=n,this.config=Object.assign(Object.assign({},Je),t)}render(n){const t=n.map(e=>{let i;return e.blocks.length?i=this.generateFileHtml(e):i=this.generateEmptyDiff(),this.makeFileDiffHtml(e,i)}).join(`
`);return this.hoganUtils.render(we,"wrapper",{colorScheme:Ie(this.config.colorScheme),content:t})}makeFileDiffHtml(n,t){if(this.config.renderNothingWhenEmpty&&Array.isArray(n.blocks)&&n.blocks.length===0)return"";const e=this.hoganUtils.template(zt,"file-diff"),i=this.hoganUtils.template(we,"file-path"),o=this.hoganUtils.template(Vt,"file"),l=this.hoganUtils.template($t,Fe(n));return e.render({file:n,fileHtmlId:ke(n),diffs:t,filePath:i.render({fileDiffName:Ne(n)},{fileIcon:o,fileTag:l})})}generateEmptyDiff(){return{right:"",left:this.hoganUtils.render(we,"empty-diff",{contentClass:"d2h-code-side-line",CSSLineClass:G})}}generateFileHtml(n){const t=Me(De(e=>ie(e.content,n.isCombined).content));return n.blocks.map(e=>{const i={left:this.makeHeaderHtml(e.header,n),right:this.makeHeaderHtml("")};return this.applyLineGroupping(e).forEach(([o,l,f])=>{if(l.length&&f.length&&!o.length)this.applyRematchMatching(l,f,t).map(([h,p])=>{const{left:v,right:x}=this.processChangedLines(n.isCombined,h,p);i.left+=v,i.right+=x});else if(o.length)o.forEach(h=>{const{prefix:p,content:v}=ie(h.content,n.isCombined),{left:x,right:L}=this.generateLineHtml({type:G.CONTEXT,prefix:p,content:v,number:h.oldNumber},{type:G.CONTEXT,prefix:p,content:v,number:h.newNumber});i.left+=x,i.right+=L});else if(l.length||f.length){const{left:h,right:p}=this.processChangedLines(n.isCombined,l,f);i.left+=h,i.right+=p}else console.error("Unknown state reached while processing groups of lines",o,l,f)}),i}).reduce((e,i)=>({left:e.left+i.left,right:e.right+i.right}),{left:"",right:""})}applyLineGroupping(n){const t=[];let e=[],i=[];for(let o=0;o<n.lines.length;o++){const l=n.lines[o];(l.type!==W.INSERT&&i.length||l.type===W.CONTEXT&&e.length>0)&&(t.push([[],e,i]),e=[],i=[]),l.type===W.CONTEXT?t.push([[l],[],[]]):l.type===W.INSERT&&e.length===0?t.push([[],[],[l]]):l.type===W.INSERT&&e.length>0?i.push(l):l.type===W.DELETE&&e.push(l)}return(e.length||i.length)&&(t.push([[],e,i]),e=[],i=[]),t}applyRematchMatching(n,t,e){const i=n.length*t.length,o=Ue(n.concat(t).map(f=>f.content.length));return i<this.config.matchingMaxComparisons&&o<this.config.maxLineSizeInBlockForComparison&&(this.config.matching==="lines"||this.config.matching==="words")?e(n,t):[[n,t]]}makeHeaderHtml(n,t){return this.hoganUtils.render(we,"block-header",{CSSLineClass:G,blockHeader:t?.isTooBig?n:pe(n),lineClass:"d2h-code-side-linenumber",contentClass:"d2h-code-side-line"})}processChangedLines(n,t,e){const i={right:"",left:""},o=Math.max(t.length,e.length);for(let l=0;l<o;l++){const f=t[l],h=e[l],p=f!==void 0&&h!==void 0?Ke(f.content,h.content,n,this.config):void 0,v=f!==void 0&&f.oldNumber!==void 0?Object.assign(Object.assign({},p!==void 0?{prefix:p.oldLine.prefix,content:p.oldLine.content,type:G.DELETE_CHANGES}:Object.assign(Object.assign({},ie(f.content,n)),{type:Te(f.type)})),{number:f.oldNumber}):void 0,x=h!==void 0&&h.newNumber!==void 0?Object.assign(Object.assign({},p!==void 0?{prefix:p.newLine.prefix,content:p.newLine.content,type:G.INSERT_CHANGES}:Object.assign(Object.assign({},ie(h.content,n)),{type:Te(h.type)})),{number:h.newNumber}):void 0,{left:L,right:a}=this.generateLineHtml(v,x);i.left+=L,i.right+=a}return i}generateLineHtml(n,t){return{left:this.generateSingleHtml(n),right:this.generateSingleHtml(t)}}generateSingleHtml(n){const t="d2h-code-side-linenumber",e="d2h-code-side-line";return this.hoganUtils.render(we,"line",{type:n?.type||`${G.CONTEXT} d2h-emptyplaceholder`,lineClass:n!==void 0?t:`${t} d2h-code-side-emptyplaceholder`,contentClass:n!==void 0?e:`${e} d2h-code-side-emptyplaceholder`,prefix:n?.prefix===" "?"&nbsp;":n?.prefix,content:n?.content,lineNumber:n?.number})}}var Se={},ze;function Gt(){return ze||(ze=1,(function(s){(function(n){var t=/\S/,e=/\"/g,i=/\n/g,o=/\r/g,l=/\\/g,f=/\u2028/,h=/\u2029/;n.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},n.scan=function(m,u){var c=m.length,k=0,O=1,V=2,M=k,z=null,q=null,$="",H=[],Q=!1,g=0,D=0,w="{{",X="}}";function re(){$.length>0&&(H.push({tag:"_t",text:new String($)}),$="")}function me(){for(var Z=!0,Y=D;Y<H.length;Y++)if(Z=n.tags[H[Y].tag]<n.tags._v||H[Y].tag=="_t"&&H[Y].text.match(t)===null,!Z)return!1;return Z}function ae(Z,Y){if(re(),Z&&me())for(var ee=D,S;ee<H.length;ee++)H[ee].text&&((S=H[ee+1])&&S.tag==">"&&(S.indent=H[ee].text.toString()),H.splice(ee,1));else Y||H.push({tag:`
`});Q=!1,D=H.length}function ce(Z,Y){var ee="="+X,S=Z.indexOf(ee,Y),ye=v(Z.substring(Z.indexOf("=",Y)+1,S)).split(" ");return w=ye[0],X=ye[ye.length-1],S+ee.length-1}for(u&&(u=u.split(" "),w=u[0],X=u[1]),g=0;g<c;g++)M==k?x(w,m,g)?(--g,re(),M=O):m.charAt(g)==`
`?ae(Q):$+=m.charAt(g):M==O?(g+=w.length-1,q=n.tags[m.charAt(g+1)],z=q?m.charAt(g+1):"_v",z=="="?(g=ce(m,g),M=k):(q&&g++,M=V),Q=g):x(X,m,g)?(H.push({tag:z,n:v($),otag:w,ctag:X,i:z=="/"?Q-w.length:g+X.length}),$="",g+=X.length-1,M=k,z=="{"&&(X=="}}"?g++:p(H[H.length-1]))):$+=m.charAt(g);return ae(Q,!0),H};function p(r){r.n.substr(r.n.length-1)==="}"&&(r.n=r.n.substring(0,r.n.length-1))}function v(r){return r.trim?r.trim():r.replace(/^\s*|\s*$/g,"")}function x(r,m,u){if(m.charAt(u)!=r.charAt(0))return!1;for(var c=1,k=r.length;c<k;c++)if(m.charAt(u+c)!=r.charAt(c))return!1;return!0}var L={_t:!0,"\n":!0,$:!0,"/":!0};function a(r,m,u,c){var k=[],O=null,V=null,M=null;for(V=u[u.length-1];r.length>0;){if(M=r.shift(),V&&V.tag=="<"&&!(M.tag in L))throw new Error("Illegal content in < super tag.");if(n.tags[M.tag]<=n.tags.$||d(M,c))u.push(M),M.nodes=a(r,M.tag,u,c);else if(M.tag=="/"){if(u.length===0)throw new Error("Closing tag without opener: /"+M.n);if(O=u.pop(),M.n!=O.n&&!y(M.n,O.n,c))throw new Error("Nesting error: "+O.n+" vs. "+M.n);return O.end=M.i,k}else M.tag==`
`&&(M.last=r.length==0||r[0].tag==`
`);k.push(M)}if(u.length>0)throw new Error("missing closing tag: "+u.pop().n);return k}function d(r,m){for(var u=0,c=m.length;u<c;u++)if(m[u].o==r.n)return r.tag="#",!0}function y(r,m,u){for(var c=0,k=u.length;c<k;c++)if(u[c].c==r&&u[c].o==m)return!0}function b(r){var m=[];for(var u in r)m.push('"'+N(u)+'": function(c,p,t,i) {'+r[u]+"}");return"{ "+m.join(",")+" }"}function T(r){var m=[];for(var u in r.partials)m.push('"'+N(u)+'":{name:"'+N(r.partials[u].name)+'", '+T(r.partials[u])+"}");return"partials: {"+m.join(",")+"}, subs: "+b(r.subs)}n.stringify=function(r,m,u){return"{code: function (c,p,i) { "+n.wrapMain(r.code)+" },"+T(r)+"}"};var E=0;n.generate=function(r,m,u){E=0;var c={code:"",subs:{},partials:{}};return n.walk(r,c),u.asString?this.stringify(c,m,u):this.makeTemplate(c,m,u)},n.wrapMain=function(r){return'var t=this;t.b(i=i||"");'+r+"return t.fl();"},n.template=n.Template,n.makeTemplate=function(r,m,u){var c=this.makePartials(r);return c.code=new Function("c","p","i",this.wrapMain(r.code)),new this.template(c,m,this,u)},n.makePartials=function(r){var m,u={subs:{},partials:r.partials,name:r.name};for(m in u.partials)u.partials[m]=this.makePartials(u.partials[m]);for(m in r.subs)u.subs[m]=new Function("c","p","t","i",r.subs[m]);return u};function N(r){return r.replace(l,"\\\\").replace(e,'\\"').replace(i,"\\n").replace(o,"\\r").replace(f,"\\u2028").replace(h,"\\u2029")}function F(r){return~r.indexOf(".")?"d":"f"}function P(r,m){var u="<"+(m.prefix||""),c=u+r.n+E++;return m.partials[c]={name:r.n,partials:{}},m.code+='t.b(t.rp("'+N(c)+'",c,p,"'+(r.indent||"")+'"));',c}n.codegen={"#":function(r,m){m.code+="if(t.s(t."+F(r.n)+'("'+N(r.n)+'",c,p,1),c,p,0,'+r.i+","+r.end+',"'+r.otag+" "+r.ctag+'")){t.rs(c,p,function(c,p,t){',n.walk(r.nodes,m),m.code+="});c.pop();}"},"^":function(r,m){m.code+="if(!t.s(t."+F(r.n)+'("'+N(r.n)+'",c,p,1),c,p,1,0,0,"")){',n.walk(r.nodes,m),m.code+="};"},">":P,"<":function(r,m){var u={partials:{},code:"",subs:{},inPartial:!0};n.walk(r.nodes,u);var c=m.partials[P(r,m)];c.subs=u.subs,c.partials=u.partials},$:function(r,m){var u={subs:{},code:"",partials:m.partials,prefix:r.n};n.walk(r.nodes,u),m.subs[r.n]=u.code,m.inPartial||(m.code+='t.sub("'+N(r.n)+'",c,p,i);')},"\n":function(r,m){m.code+=le('"\\n"'+(r.last?"":" + i"))},_v:function(r,m){m.code+="t.b(t.v(t."+F(r.n)+'("'+N(r.n)+'",c,p,0)));'},_t:function(r,m){m.code+=le('"'+N(r.text)+'"')},"{":I,"&":I};function I(r,m){m.code+="t.b(t.t(t."+F(r.n)+'("'+N(r.n)+'",c,p,0)));'}function le(r){return"t.b("+r+");"}n.walk=function(r,m){for(var u,c=0,k=r.length;c<k;c++)u=n.codegen[r[c].tag],u&&u(r[c],m);return m},n.parse=function(r,m,u){return u=u||{},a(r,"",[],u.sectionTags||[])},n.cache={},n.cacheKey=function(r,m){return[r,!!m.asString,!!m.disableLambda,m.delimiters,!!m.modelGet].join("||")},n.compile=function(r,m){m=m||{};var u=n.cacheKey(r,m),c=this.cache[u];if(c){var k=c.partials;for(var O in k)delete k[O].instance;return c}return c=this.generate(this.parse(this.scan(r,m.delimiters),r,m),r,m),this.cache[u]=c}})(s)})(Se)),Se}var Le={},Ve;function Xt(){return Ve||(Ve=1,(function(s){(function(n){n.Template=function(a,d,y,b){a=a||{},this.r=a.code||this.r,this.c=y,this.options=b||{},this.text=d||"",this.partials=a.partials||{},this.subs=a.subs||{},this.buf=""},n.Template.prototype={r:function(a,d,y){return""},v:x,t:v,render:function(d,y,b){return this.ri([d],y||{},b)},ri:function(a,d,y){return this.r(a,d,y)},ep:function(a,d){var y=this.partials[a],b=d[y.name];if(y.instance&&y.base==b)return y.instance;if(typeof b=="string"){if(!this.c)throw new Error("No compiler available.");b=this.c.compile(b,this.options)}if(!b)return null;if(this.partials[a].base=b,y.subs){d.stackText||(d.stackText={});for(key in y.subs)d.stackText[key]||(d.stackText[key]=this.activeSub!==void 0&&d.stackText[this.activeSub]?d.stackText[this.activeSub]:this.text);b=e(b,y.subs,y.partials,this.stackSubs,this.stackPartials,d.stackText)}return this.partials[a].instance=b,b},rp:function(a,d,y,b){var T=this.ep(a,y);return T?T.ri(d,y,b):""},rs:function(a,d,y){var b=a[a.length-1];if(!L(b)){y(a,d,this);return}for(var T=0;T<b.length;T++)a.push(b[T]),y(a,d,this),a.pop()},s:function(a,d,y,b,T,E,N){var F;return L(a)&&a.length===0?!1:(typeof a=="function"&&(a=this.ms(a,d,y,b,T,E,N)),F=!!a,!b&&F&&d&&d.push(typeof a=="object"?a:d[d.length-1]),F)},d:function(a,d,y,b){var T,E=a.split("."),N=this.f(E[0],d,y,b),F=this.options.modelGet,P=null;if(a==="."&&L(d[d.length-2]))N=d[d.length-1];else for(var I=1;I<E.length;I++)T=t(E[I],N,F),T!==void 0?(P=N,N=T):N="";return b&&!N?!1:(!b&&typeof N=="function"&&(d.push(P),N=this.mv(N,d,y),d.pop()),N)},f:function(a,d,y,b){for(var T=!1,E=null,N=!1,F=this.options.modelGet,P=d.length-1;P>=0;P--)if(E=d[P],T=t(a,E,F),T!==void 0){N=!0;break}return N?(!b&&typeof T=="function"&&(T=this.mv(T,d,y)),T):b?!1:""},ls:function(a,d,y,b,T,E){var N=this.options.delimiters;return this.options.delimiters=E,this.b(this.ct(v(a.call(d,T,y)),d,b)),this.options.delimiters=N,!1},ct:function(a,d,y){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(a,this.options).render(d,y)},b:function(a){this.buf+=a},fl:function(){var a=this.buf;return this.buf="",a},ms:function(a,d,y,b,T,E,N){var F,P=d[d.length-1],I=a.call(P);return typeof I=="function"?b?!0:(F=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(I,P,d,y,F.substring(T,E),N)):I},mv:function(a,d,y){var b=d[d.length-1],T=a.call(b);return typeof T=="function"?this.ct(v(T.call(b)),b,y):T},sub:function(a,d,y,b){var T=this.subs[a];T&&(this.activeSub=a,T(d,y,this,b),this.activeSub=!1)}};function t(a,d,y){var b;return d&&typeof d=="object"&&(d[a]!==void 0?b=d[a]:y&&d.get&&typeof d.get=="function"&&(b=d.get(a))),b}function e(a,d,y,b,T,E){function N(){}N.prototype=a;function F(){}F.prototype=a.subs;var P,I=new N;I.subs=new F,I.subsText={},I.buf="",b=b||{},I.stackSubs=b,I.subsText=E;for(P in d)b[P]||(b[P]=d[P]);for(P in b)I.subs[P]=b[P];T=T||{},I.stackPartials=T;for(P in y)T[P]||(T[P]=y[P]);for(P in T)I.partials[P]=T[P];return I}var i=/&/g,o=/</g,l=/>/g,f=/\'/g,h=/\"/g,p=/[&<>\"\']/;function v(a){return String(a??"")}function x(a){return a=v(a),p.test(a)?a.replace(i,"&amp;").replace(o,"&lt;").replace(l,"&gt;").replace(f,"&#39;").replace(h,"&quot;"):a}var L=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"}})(s)})(Le)),Le}var Pe,$e;function Kt(){if($e)return Pe;$e=1;var s=Gt();return s.Template=Xt().Template,s.template=s.Template,Pe=s,Pe}var B=Kt();const j={};j["file-summary-line"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<li class="d2h-file-list-line">'),e.b(`
`+t),e.b('    <span class="d2h-file-name-wrapper">'),e.b(`
`+t),e.b(e.rp("<fileIcon0",s,n,"      ")),e.b('      <a href="#'),e.b(e.v(e.f("fileHtmlId",s,n,0))),e.b('" class="d2h-file-name">'),e.b(e.v(e.f("fileName",s,n,0))),e.b("</a>"),e.b(`
`+t),e.b('      <span class="d2h-file-stats">'),e.b(`
`+t),e.b('          <span class="d2h-lines-added">'),e.b(e.v(e.f("addedLines",s,n,0))),e.b("</span>"),e.b(`
`+t),e.b('          <span class="d2h-lines-deleted">'),e.b(e.v(e.f("deletedLines",s,n,0))),e.b("</span>"),e.b(`
`+t),e.b("      </span>"),e.b(`
`+t),e.b("    </span>"),e.b(`
`+t),e.b("</li>"),e.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}}},subs:{}});j["file-summary-wrapper"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<div class="d2h-file-list-wrapper '),e.b(e.v(e.f("colorScheme",s,n,0))),e.b('">'),e.b(`
`+t),e.b('    <div class="d2h-file-list-header">'),e.b(`
`+t),e.b('        <span class="d2h-file-list-title">Files changed ('),e.b(e.v(e.f("filesNumber",s,n,0))),e.b(")</span>"),e.b(`
`+t),e.b('        <a class="d2h-file-switch d2h-hide">hide</a>'),e.b(`
`+t),e.b('        <a class="d2h-file-switch d2h-show">show</a>'),e.b(`
`+t),e.b("    </div>"),e.b(`
`+t),e.b('    <ol class="d2h-file-list">'),e.b(`
`+t),e.b("    "),e.b(e.t(e.f("files",s,n,0))),e.b(`
`+t),e.b("    </ol>"),e.b(`
`+t),e.b("</div>"),e.fl()},partials:{},subs:{}});j["generic-block-header"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b("<tr>"),e.b(`
`+t),e.b('    <td class="'),e.b(e.v(e.f("lineClass",s,n,0))),e.b(" "),e.b(e.v(e.d("CSSLineClass.INFO",s,n,0))),e.b('"></td>'),e.b(`
`+t),e.b('    <td class="'),e.b(e.v(e.d("CSSLineClass.INFO",s,n,0))),e.b('">'),e.b(`
`+t),e.b('        <div class="'),e.b(e.v(e.f("contentClass",s,n,0))),e.b('">'),e.s(e.f("blockHeader",s,n,1),s,n,0,156,173,"{{ }}")&&(e.rs(s,n,function(i,o,l){l.b(l.t(l.f("blockHeader",i,o,0)))}),s.pop()),e.s(e.f("blockHeader",s,n,1),s,n,1,0,0,"")||e.b("&nbsp;"),e.b("</div>"),e.b(`
`+t),e.b("    </td>"),e.b(`
`+t),e.b("</tr>"),e.fl()},partials:{},subs:{}});j["generic-empty-diff"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b("<tr>"),e.b(`
`+t),e.b('    <td class="'),e.b(e.v(e.d("CSSLineClass.INFO",s,n,0))),e.b('">'),e.b(`
`+t),e.b('        <div class="'),e.b(e.v(e.f("contentClass",s,n,0))),e.b('">'),e.b(`
`+t),e.b("            File without changes"),e.b(`
`+t),e.b("        </div>"),e.b(`
`+t),e.b("    </td>"),e.b(`
`+t),e.b("</tr>"),e.fl()},partials:{},subs:{}});j["generic-file-path"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<span class="d2h-file-name-wrapper">'),e.b(`
`+t),e.b(e.rp("<fileIcon0",s,n,"    ")),e.b('    <span class="d2h-file-name">'),e.b(e.v(e.f("fileDiffName",s,n,0))),e.b("</span>"),e.b(`
`+t),e.b(e.rp("<fileTag1",s,n,"    ")),e.b("</span>"),e.b(`
`+t),e.b('<label class="d2h-file-collapse">'),e.b(`
`+t),e.b('    <input class="d2h-file-collapse-input" type="checkbox" name="viewed" value="viewed">'),e.b(`
`+t),e.b("    Viewed"),e.b(`
`+t),e.b("</label>"),e.fl()},partials:{"<fileIcon0":{name:"fileIcon",partials:{},subs:{}},"<fileTag1":{name:"fileTag",partials:{},subs:{}}},subs:{}});j["generic-line"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b("<tr>"),e.b(`
`+t),e.b('    <td class="'),e.b(e.v(e.f("lineClass",s,n,0))),e.b(" "),e.b(e.v(e.f("type",s,n,0))),e.b('">'),e.b(`
`+t),e.b("      "),e.b(e.t(e.f("lineNumber",s,n,0))),e.b(`
`+t),e.b("    </td>"),e.b(`
`+t),e.b('    <td class="'),e.b(e.v(e.f("type",s,n,0))),e.b('">'),e.b(`
`+t),e.b('        <div class="'),e.b(e.v(e.f("contentClass",s,n,0))),e.b('">'),e.b(`
`+t),e.s(e.f("prefix",s,n,1),s,n,0,162,238,"{{ }}")&&(e.rs(s,n,function(i,o,l){l.b('            <span class="d2h-code-line-prefix">'),l.b(l.t(l.f("prefix",i,o,0))),l.b("</span>"),l.b(`
`+t)}),s.pop()),e.s(e.f("prefix",s,n,1),s,n,1,0,0,"")||(e.b('            <span class="d2h-code-line-prefix">&nbsp;</span>'),e.b(`
`+t)),e.s(e.f("content",s,n,1),s,n,0,371,445,"{{ }}")&&(e.rs(s,n,function(i,o,l){l.b('            <span class="d2h-code-line-ctn">'),l.b(l.t(l.f("content",i,o,0))),l.b("</span>"),l.b(`
`+t)}),s.pop()),e.s(e.f("content",s,n,1),s,n,1,0,0,"")||(e.b('            <span class="d2h-code-line-ctn"><br></span>'),e.b(`
`+t)),e.b("        </div>"),e.b(`
`+t),e.b("    </td>"),e.b(`
`+t),e.b("</tr>"),e.fl()},partials:{},subs:{}});j["generic-wrapper"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<div class="d2h-wrapper '),e.b(e.v(e.f("colorScheme",s,n,0))),e.b('">'),e.b(`
`+t),e.b("    "),e.b(e.t(e.f("content",s,n,0))),e.b(`
`+t),e.b("</div>"),e.fl()},partials:{},subs:{}});j["icon-file-added"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-added" height="16" title="added" version="1.1" viewBox="0 0 14 16"'),e.b(`
`+t),e.b('     width="14">'),e.b(`
`+t),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM6 9H3V7h3V4h2v3h3v2H8v3H6V9z"></path>'),e.b(`
`+t),e.b("</svg>"),e.fl()},partials:{},subs:{}});j["icon-file-changed"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-changed" height="16" title="modified" version="1.1"'),e.b(`
`+t),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+t),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM4 8c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3-3-1.34-3-3z"></path>'),e.b(`
`+t),e.b("</svg>"),e.fl()},partials:{},subs:{}});j["icon-file-deleted"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-deleted" height="16" title="removed" version="1.1"'),e.b(`
`+t),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+t),e.b('    <path d="M13 1H1C0.45 1 0 1.45 0 2v12c0 0.55 0.45 1 1 1h12c0.55 0 1-0.45 1-1V2c0-0.55-0.45-1-1-1z m0 13H1V2h12v12zM11 9H3V7h8v2z"></path>'),e.b(`
`+t),e.b("</svg>"),e.fl()},partials:{},subs:{}});j["icon-file-renamed"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<svg aria-hidden="true" class="d2h-icon d2h-moved" height="16" title="renamed" version="1.1"'),e.b(`
`+t),e.b('     viewBox="0 0 14 16" width="14">'),e.b(`
`+t),e.b('    <path d="M6 9H3V7h3V4l5 4-5 4V9z m8-7v12c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h12c0.55 0 1 0.45 1 1z m-1 0H1v12h12V2z"></path>'),e.b(`
`+t),e.b("</svg>"),e.fl()},partials:{},subs:{}});j["icon-file"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">'),e.b(`
`+t),e.b('    <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>'),e.b(`
`+t),e.b("</svg>"),e.fl()},partials:{},subs:{}});j["line-by-line-file-diff"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<div id="'),e.b(e.v(e.f("fileHtmlId",s,n,0))),e.b('" class="d2h-file-wrapper" data-lang="'),e.b(e.v(e.d("file.language",s,n,0))),e.b('">'),e.b(`
`+t),e.b('    <div class="d2h-file-header">'),e.b(`
`+t),e.b("    "),e.b(e.t(e.f("filePath",s,n,0))),e.b(`
`+t),e.b("    </div>"),e.b(`
`+t),e.b('    <div class="d2h-file-diff">'),e.b(`
`+t),e.b('        <div class="d2h-code-wrapper">'),e.b(`
`+t),e.b('            <table class="d2h-diff-table">'),e.b(`
`+t),e.b('                <tbody class="d2h-diff-tbody">'),e.b(`
`+t),e.b("                "),e.b(e.t(e.f("diffs",s,n,0))),e.b(`
`+t),e.b("                </tbody>"),e.b(`
`+t),e.b("            </table>"),e.b(`
`+t),e.b("        </div>"),e.b(`
`+t),e.b("    </div>"),e.b(`
`+t),e.b("</div>"),e.fl()},partials:{},subs:{}});j["line-by-line-numbers"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<div class="line-num1">'),e.b(e.v(e.f("oldNumber",s,n,0))),e.b("</div>"),e.b(`
`+t),e.b('<div class="line-num2">'),e.b(e.v(e.f("newNumber",s,n,0))),e.b("</div>"),e.fl()},partials:{},subs:{}});j["side-by-side-file-diff"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<div id="'),e.b(e.v(e.f("fileHtmlId",s,n,0))),e.b('" class="d2h-file-wrapper" data-lang="'),e.b(e.v(e.d("file.language",s,n,0))),e.b('">'),e.b(`
`+t),e.b('    <div class="d2h-file-header">'),e.b(`
`+t),e.b("      "),e.b(e.t(e.f("filePath",s,n,0))),e.b(`
`+t),e.b("    </div>"),e.b(`
`+t),e.b('    <div class="d2h-files-diff">'),e.b(`
`+t),e.b('        <div class="d2h-file-side-diff">'),e.b(`
`+t),e.b('            <div class="d2h-code-wrapper">'),e.b(`
`+t),e.b('                <table class="d2h-diff-table">'),e.b(`
`+t),e.b('                    <tbody class="d2h-diff-tbody">'),e.b(`
`+t),e.b("                    "),e.b(e.t(e.d("diffs.left",s,n,0))),e.b(`
`+t),e.b("                    </tbody>"),e.b(`
`+t),e.b("                </table>"),e.b(`
`+t),e.b("            </div>"),e.b(`
`+t),e.b("        </div>"),e.b(`
`+t),e.b('        <div class="d2h-file-side-diff">'),e.b(`
`+t),e.b('            <div class="d2h-code-wrapper">'),e.b(`
`+t),e.b('                <table class="d2h-diff-table">'),e.b(`
`+t),e.b('                    <tbody class="d2h-diff-tbody">'),e.b(`
`+t),e.b("                    "),e.b(e.t(e.d("diffs.right",s,n,0))),e.b(`
`+t),e.b("                    </tbody>"),e.b(`
`+t),e.b("                </table>"),e.b(`
`+t),e.b("            </div>"),e.b(`
`+t),e.b("        </div>"),e.b(`
`+t),e.b("    </div>"),e.b(`
`+t),e.b("</div>"),e.fl()},partials:{},subs:{}});j["tag-file-added"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<span class="d2h-tag d2h-added d2h-added-tag">ADDED</span>'),e.fl()},partials:{},subs:{}});j["tag-file-changed"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<span class="d2h-tag d2h-changed d2h-changed-tag">CHANGED</span>'),e.fl()},partials:{},subs:{}});j["tag-file-deleted"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<span class="d2h-tag d2h-deleted d2h-deleted-tag">DELETED</span>'),e.fl()},partials:{},subs:{}});j["tag-file-renamed"]=new B.Template({code:function(s,n,t){var e=this;return e.b(t=t||""),e.b('<span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>'),e.fl()},partials:{},subs:{}});class qt{constructor({compiledTemplates:n={},rawTemplates:t={}}){const e=Object.entries(t).reduce((i,[o,l])=>{const f=B.compile(l,{asString:!1});return Object.assign(Object.assign({},i),{[o]:f})},{});this.preCompiledTemplates=Object.assign(Object.assign(Object.assign({},j),n),e)}static compile(n){return B.compile(n,{asString:!1})}render(n,t,e,i,o){const l=this.templateKey(n,t);try{return this.preCompiledTemplates[l].render(e,i,o)}catch{throw new Error(`Could not find template to render '${l}'`)}}template(n,t){return this.preCompiledTemplates[this.templateKey(n,t)]}templateKey(n,t){return`${n}-${t}`}}const Jt=Object.assign(Object.assign(Object.assign({},qe),Je),{outputFormat:mt.LINE_BY_LINE,drawFileList:!0});function Yt(s,n={}){const t=Object.assign(Object.assign({},Jt),n),e=typeof s=="string"?xt(s,t):s,i=new qt(t),{colorScheme:o}=t,l={colorScheme:o},f=t.drawFileList?new Rt(i,l).render(e):"",h=t.outputFormat==="side-by-side"?new Ut(i,t).render(e):new jt(i,t).render(e);return f+h}const Qt={class:"compare-page"},Zt={class:"page-header"},en={class:"header-left"},tn={class:"form-label"},nn={class:"file-list"},sn=["onClick"],ln={class:"file-stat"},an={class:"diff-header"},rn=["innerHTML"],on={key:0,class:"mb-3"},cn={key:1},dn=Ye({__name:"BranchComparePage",setup(s){const t=et().params.repoKey,e=J([]),i=J(""),o=J(""),l=J(!1),f=J(null),h=J(""),p=J(""),v=J("line-by-line"),x=J(!1),L=J(!1),a=J(null),d=J(!1),y=J({message:""}),b=xe(()=>e.value.filter(u=>u.type==="local").map(u=>u.name)),T=xe(()=>e.value.filter(u=>u.type==="remote").map(u=>u.name));function E(u){return T.value.includes(u)}const N=xe(()=>o.value&&!E(o.value));Qe(async()=>{try{const u=await ot(t,{page_size:1e3});e.value=u.list||[]}catch{}}),Ze(v,()=>{h.value&&I(h.value)});function F(u){return u==="A"?"success":u==="D"?"danger":u==="M"?"warning":u==="R"?"info":""}async function P(){if(!i.value||!o.value){_e.warning("请选择源分支和目标分支");return}l.value=!0,f.value=null,h.value="",p.value="";try{f.value=await ct(t,i.value,o.value)}finally{l.value=!1}}async function I(u){h.value=u;try{const c=await ht(t,i.value,o.value,u);p.value=Yt(c.diff||"",{drawFileList:!1,matching:"lines",outputFormat:v.value})}catch{p.value="<p>加载差异失败</p>"}}async function le(){try{const u=await dt(t,i.value,o.value),c=u.data instanceof Blob?u.data:new Blob([u.data],{type:"application/octet-stream"}),k=window.URL.createObjectURL(c),O=document.createElement("a");O.href=k,O.download=`${i.value}-to-${o.value}.patch`,O.click(),window.URL.revokeObjectURL(k)}catch(u){const c=u;_e.error("导出 Patch 失败: "+(c.message||"未知错误"))}}async function r(){x.value=!0,L.value=!0,a.value=null,y.value.message=`Merge ${i.value} into ${o.value}`;try{a.value=await ut(t,i.value,o.value)}finally{L.value=!1}}async function m(){d.value=!0;try{await ft({repo_key:t,source:i.value,target:o.value,message:y.value.message}),_e.success("合并成功"),x.value=!1,await P()}finally{d.value=!1}}return(u,c)=>{const k=R("el-button"),O=R("el-option"),V=R("el-option-group"),M=R("el-select"),z=R("el-col"),q=R("el-icon"),$=R("el-text"),H=R("el-button-group"),Q=R("el-row"),g=R("el-alert"),D=R("el-card"),w=R("el-statistic"),X=R("el-tag"),re=R("el-radio-button"),me=R("el-radio-group"),ae=R("el-empty"),ce=R("el-input"),Z=R("el-form-item"),Y=R("el-form"),ee=R("el-dialog");return A(),te("div",Qt,[K("div",Zt,[K("div",en,[C(k,{onClick:c[0]||(c[0]=S=>u.$router.push(`/repos/${de(t)}/branches`)),icon:de(nt),text:""},{default:_(()=>[...c[7]||(c[7]=[U("返回",-1)])]),_:1},8,["icon"]),c[8]||(c[8]=K("h2",null,"分支对比 & 合并",-1))])]),C(D,{class:"mb-4"},{default:_(()=>[C(Q,{gutter:16,align:"middle"},{default:_(()=>[C(z,{span:8},{default:_(()=>[c[9]||(c[9]=K("div",{class:"form-label"},"源分支 (Source/Feature)",-1)),C(M,{modelValue:i.value,"onUpdate:modelValue":c[1]||(c[1]=S=>i.value=S),placeholder:"选择源分支",filterable:"",style:{width:"100%"}},{default:_(()=>[C(V,{label:"本地分支"},{default:_(()=>[(A(!0),te(be,null,ge(b.value,S=>(A(),ne(O,{key:S,label:S,value:S},null,8,["label","value"]))),128))]),_:1}),C(V,{label:"远程分支"},{default:_(()=>[(A(!0),te(be,null,ge(T.value,S=>(A(),ne(O,{key:S,label:S,value:S},null,8,["label","value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1}),C(z,{span:2,class:"text-center"},{default:_(()=>[C(q,{size:24,color:"#909399"},{default:_(()=>[C(de(st))]),_:1})]),_:1}),C(z,{span:8},{default:_(()=>[K("div",tn,[c[11]||(c[11]=U("目标分支 (Target/Base) ",-1)),C($,{type:"info",size:"small"},{default:_(()=>[...c[10]||(c[10]=[U("仅本地分支",-1)])]),_:1})]),C(M,{modelValue:o.value,"onUpdate:modelValue":c[2]||(c[2]=S=>o.value=S),placeholder:"选择目标分支",filterable:"",style:{width:"100%"}},{default:_(()=>[(A(!0),te(be,null,ge(b.value,S=>(A(),ne(O,{key:S,label:S,value:S},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),C(z,{span:6,class:"text-right"},{default:_(()=>[C(H,null,{default:_(()=>[C(k,{type:"primary",onClick:P,loading:l.value},{default:_(()=>[C(q,null,{default:_(()=>[C(de(it))]),_:1}),c[12]||(c[12]=U(" 对比 ",-1))]),_:1},8,["loading"]),C(k,{type:"success",onClick:r,disabled:!f.value||!N.value},{default:_(()=>[C(q,null,{default:_(()=>[C(de(lt))]),_:1}),c[13]||(c[13]=U(" 合并 ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),o.value&&E(o.value)?(A(),ne(g,{key:0,title:"目标分支不能是远程分支",type:"warning",closable:!1,"show-icon":"",class:"mt-3",description:"Git 合并只能在本地分支上执行，请选择本地分支作为目标分支。"})):ue("",!0)]),_:1}),f.value?(A(),ne(Q,{key:0,gutter:16,class:"mb-4"},{default:_(()=>[C(z,{span:6},{default:_(()=>[C(D,{shadow:"hover"},{default:_(()=>[C(w,{title:"变更文件",value:f.value.stat.FilesChanged},null,8,["value"])]),_:1})]),_:1}),C(z,{span:6},{default:_(()=>[C(D,{shadow:"hover"},{default:_(()=>[C(w,{title:"新增行数",value:f.value.stat.Insertions,"value-style":{color:"#67c23a"}},null,8,["value"])]),_:1})]),_:1}),C(z,{span:6},{default:_(()=>[C(D,{shadow:"hover"},{default:_(()=>[C(w,{title:"删除行数",value:f.value.stat.Deletions,"value-style":{color:"#f56c6c"}},null,8,["value"])]),_:1})]),_:1}),C(z,{span:6},{default:_(()=>[C(D,{shadow:"hover",class:"download-card"},{default:_(()=>[C(k,{type:"info",onClick:le},{default:_(()=>[C(q,null,{default:_(()=>[C(de(at))]),_:1}),c[14]||(c[14]=U(" 导出 Patch ",-1))]),_:1})]),_:1})]),_:1})]),_:1})):ue("",!0),f.value?(A(),ne(Q,{key:1,gutter:16},{default:_(()=>[C(z,{span:6},{default:_(()=>[C(D,{header:"变更文件列表"},{default:_(()=>[K("div",nn,[(A(!0),te(be,null,ge(f.value.files,S=>(A(),te("div",{key:S.path,class:tt(["file-item",{active:S.path===h.value}]),onClick:ye=>I(S.path)},[C($,{size:"small",truncated:""},{default:_(()=>[U(fe(S.path),1)]),_:2},1024),K("div",ln,[C(X,{size:"small",type:F(S.status)},{default:_(()=>[U(fe(S.status),1)]),_:2},1032,["type"])])],10,sn))),128))])]),_:1})]),_:1}),C(z,{span:18},{default:_(()=>[C(D,null,{header:_(()=>[K("div",an,[C($,null,{default:_(()=>[U(fe(h.value||"选择文件查看差异"),1)]),_:1}),C(me,{modelValue:v.value,"onUpdate:modelValue":c[3]||(c[3]=S=>v.value=S),size:"small"},{default:_(()=>[C(re,{value:"line-by-line"},{default:_(()=>[...c[15]||(c[15]=[U("Line",-1)])]),_:1}),C(re,{value:"side-by-side"},{default:_(()=>[...c[16]||(c[16]=[U("Side",-1)])]),_:1})]),_:1},8,["modelValue"])])]),default:_(()=>[K("div",{id:"diff-viewer",innerHTML:p.value,class:"diff-content"},null,8,rn)]),_:1})]),_:1})]),_:1})):ue("",!0),!f.value&&!l.value?(A(),ne(ae,{key:2,description:"请选择分支进行对比"})):ue("",!0),C(ee,{modelValue:x.value,"onUpdate:modelValue":c[6]||(c[6]=S=>x.value=S),title:"合并分支",width:"550px","destroy-on-close":""},{footer:_(()=>[C(k,{onClick:c[5]||(c[5]=S=>x.value=!1)},{default:_(()=>[...c[21]||(c[21]=[U("取消",-1)])]),_:1}),C(k,{type:"success",onClick:m,disabled:!a.value?.success,loading:d.value},{default:_(()=>[...c[22]||(c[22]=[U(" 确认合并 ",-1)])]),_:1},8,["disabled","loading"])]),default:_(()=>[K("p",null,[c[17]||(c[17]=U(" 即将合并 ",-1)),K("strong",null,fe(i.value),1),c[18]||(c[18]=U(" 到 ",-1)),K("strong",null,fe(o.value),1)]),L.value?(A(),te("div",on,[C(q,{class:"is-loading"},{default:_(()=>[C(de(rt))]),_:1}),c[19]||(c[19]=U(" 正在检测冲突... ",-1))])):ue("",!0),a.value&&!L.value?(A(),te("div",cn,[a.value.success?(A(),ne(g,{key:0,title:"可以自动合并",type:"success",closable:!1,"show-icon":"",class:"mb-3"})):(A(),ne(g,{key:1,title:"检测到冲突",type:"error",closable:!1,"show-icon":"",class:"mb-3"},{default:_(()=>[c[20]||(c[20]=K("p",null,"无法自动合并。以下文件存在冲突：",-1)),K("ul",null,[(A(!0),te(be,null,ge(a.value.conflicts,S=>(A(),te("li",{key:S},fe(S),1))),128))])]),_:1}))])):ue("",!0),a.value?.success?(A(),ne(Y,{key:2,model:y.value,"label-width":"100px"},{default:_(()=>[C(Z,{label:"合并信息"},{default:_(()=>[C(ce,{modelValue:y.value.message,"onUpdate:modelValue":c[4]||(c[4]=S=>y.value.message=S),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])):ue("",!0)]),_:1},8,["modelValue"])])}}}),bn=pt(dn,[["__scopeId","data-v-82ba261a"]]);export{bn as default};
